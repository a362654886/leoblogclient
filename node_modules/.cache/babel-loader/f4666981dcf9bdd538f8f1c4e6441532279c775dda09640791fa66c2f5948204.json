{"ast":null,"code":"import _slicedToArray from\"D:/Github/Leo_log_project/leoblogclient/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Button,Checkbox,FormControl,ListItemText,MenuItem,OutlinedInput,Select,TextField}from\"@mui/material\";import{useEffect,useState}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import{useQueryBlog,useQueryPostTypes,useUpdatePost}from\"../../hooks/usePost\";import FullTextEditor from\"./components/FullTextEditor/FullTextEditor\";import{FullTextEditDiv,StyledBlogAddBody}from\"./style\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var BlogUpdatePage=function BlogUpdatePage(){var history=useNavigate();var params=useParams();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),html=_useState2[0],setHtml=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),types=_useState6[0],setTypes=_useState6[1];var _useQueryPostTypes=useQueryPostTypes(),postTypesLoading=_useQueryPostTypes.loading,postTypesData=_useQueryPostTypes._data;var _useQueryBlog=useQueryBlog(params!==null&&params!==void 0&&params.id?params===null||params===void 0?void 0:params.id:\"\"),postGetLoading=_useQueryBlog.loading,error=_useQueryBlog.error,postData=_useQueryBlog._data;var _useUpdatePost=useUpdatePost(),updatePostFunction=_useUpdatePost.updatePostFunction,loading=_useUpdatePost.loading;var updateBlog=function updateBlog(){var typeIds=types.map(function(type){return postTypesData.find(function(e){return e.type===type;}).id;});updatePostFunction({variables:{id:params!==null&&params!==void 0&&params.id?params===null||params===void 0?void 0:params.id:\"\",types:typeIds,title:title,context:html}}).then(function(r){history(\"/blogs/null\");}).catch(function(error){console.log(error);});};useEffect(function(){if(!postGetLoading){setHtml(postData.context);setTitle(postData.title);var _types=postData.types?postData.types.map(function(type){return type.type;}):[];setTypes(_types);}},[postGetLoading]);return/*#__PURE__*/_jsx(_Fragment,{children:postTypesLoading||postGetLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading\"}):/*#__PURE__*/_jsxs(StyledBlogAddBody,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"updatePage\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Title:\"}),/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",variant:\"outlined\",inputProps:{\"aria-label\":\"Without label\"},value:title,onChange:function onChange(v){return setTitle(v.target.value);}}),/*#__PURE__*/_jsx(\"h3\",{children:\"Types:\"}),/*#__PURE__*/_jsx(FormControl,{sx:{m:0,width:300,mt:3},children:/*#__PURE__*/_jsx(Select,{multiple:true,displayEmpty:true,value:types,onChange:function onChange(v){return setTypes(typeof v.target.value==\"string\"?v.target.value.split(\",\"):v.target.value);},input:/*#__PURE__*/_jsx(OutlinedInput,{}),renderValue:function renderValue(selected){return selected.join(\", \");},inputProps:{\"aria-label\":\"Without label\"},children:postTypesData.map(function(postType){return/*#__PURE__*/_jsxs(MenuItem,{value:postType.type,children:[/*#__PURE__*/_jsx(Checkbox,{checked:types.indexOf(postType.type)>-1}),/*#__PURE__*/_jsx(ListItemText,{primary:postType.type})]},postType.id);})})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Context:\"}),/*#__PURE__*/_jsx(FullTextEditDiv,{children:/*#__PURE__*/_jsx(FullTextEditor,{html:html,setFullText:function setFullText(e){setHtml(e);}})}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return updateBlog();},variant:\"contained\",children:\"Update\"})]})});};export default BlogUpdatePage;","map":{"version":3,"names":["Button","Checkbox","FormControl","ListItemText","MenuItem","OutlinedInput","Select","TextField","useEffect","useState","useNavigate","useParams","useQueryBlog","useQueryPostTypes","useUpdatePost","FullTextEditor","FullTextEditDiv","StyledBlogAddBody","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","BlogUpdatePage","history","params","_useState","_useState2","_slicedToArray","html","setHtml","_useState3","_useState4","title","setTitle","_useState5","_useState6","types","setTypes","_useQueryPostTypes","postTypesLoading","loading","postTypesData","_data","_useQueryBlog","id","postGetLoading","error","postData","_useUpdatePost","updatePostFunction","updateBlog","typeIds","map","type","find","e","variables","context","then","r","catch","console","log","children","variant","inputProps","value","onChange","v","target","sx","m","width","mt","multiple","displayEmpty","split","input","renderValue","selected","join","postType","checked","indexOf","primary","setFullText","onClick"],"sources":["D:/Github/Leo_log_project/leoblogclient/src/pages/BlogUpdatePage/BlogUpdatePage.tsx"],"sourcesContent":["import {\r\n  Button,\r\n  Checkbox,\r\n  FormControl,\r\n  ListItemText,\r\n  MenuItem,\r\n  OutlinedInput,\r\n  Select,\r\n  TextField,\r\n} from \"@mui/material\";\r\nimport { FC, useEffect, useState } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport {\r\n  useAddPost,\r\n  useQueryBlog,\r\n  useQueryPostTypes,\r\n  useUpdatePost,\r\n} from \"../../hooks/usePost\";\r\nimport { PostType } from \"../../types/postType\";\r\nimport FullTextEditor from \"./components/FullTextEditor/FullTextEditor\";\r\nimport { FullTextEditDiv, StyledBlogAddBody } from \"./style\";\r\n\r\nconst BlogUpdatePage: FC = () => {\r\n  const history = useNavigate();\r\n\r\n  const params = useParams();\r\n\r\n  const [html, setHtml] = useState<string>(\"\");\r\n  const [title, setTitle] = useState<string>(\"\");\r\n  const [types, setTypes] = useState<string[]>([]);\r\n\r\n  const { loading: postTypesLoading, _data: postTypesData } =\r\n    useQueryPostTypes();\r\n\r\n  const {\r\n    loading: postGetLoading,\r\n    error,\r\n    _data: postData,\r\n  } = useQueryBlog(params?.id ? params?.id : \"\");\r\n\r\n  const { updatePostFunction, loading } = useUpdatePost();\r\n\r\n  const updateBlog = () => {\r\n    const typeIds = types.map(\r\n      (type) => postTypesData.find((e: PostType) => e.type === type).id\r\n    );\r\n    updatePostFunction({\r\n      variables: {\r\n        id: params?.id ? params?.id : \"\",\r\n        types: typeIds,\r\n        title: title,\r\n        context: html,\r\n      },\r\n    })\r\n      .then((r) => {\r\n        history(`/blogs/null`);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!postGetLoading) {\r\n      setHtml(postData.context);\r\n      setTitle(postData.title);\r\n      const types = postData.types\r\n        ? postData.types.map((type) => type.type)\r\n        : [];\r\n      setTypes(types);\r\n    }\r\n  }, [postGetLoading]);\r\n\r\n  return (\r\n    <>\r\n      {postTypesLoading || postGetLoading ? (\r\n        <p>Loading</p>\r\n      ) : (\r\n        <StyledBlogAddBody>\r\n          <h2>updatePage</h2>\r\n          <h3>Title:</h3>\r\n          <TextField\r\n            id=\"outlined-basic\"\r\n            variant=\"outlined\"\r\n            inputProps={{ \"aria-label\": \"Without label\" }}\r\n            value={title}\r\n            onChange={(v) => setTitle(v.target.value)}\r\n          />\r\n          <h3>Types:</h3>\r\n          <FormControl sx={{ m: 0, width: 300, mt: 3 }}>\r\n            <Select\r\n              multiple\r\n              displayEmpty\r\n              value={types}\r\n              onChange={(v) =>\r\n                setTypes(\r\n                  typeof v.target.value == \"string\"\r\n                    ? v.target.value.split(\",\")\r\n                    : v.target.value\r\n                )\r\n              }\r\n              input={<OutlinedInput />}\r\n              renderValue={(selected) => selected.join(\", \")}\r\n              inputProps={{ \"aria-label\": \"Without label\" }}\r\n            >\r\n              {postTypesData.map((postType: PostType) => (\r\n                <MenuItem key={postType.id} value={postType.type}>\r\n                  <Checkbox checked={types.indexOf(postType.type) > -1} />\r\n                  <ListItemText primary={postType.type} />\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </FormControl>\r\n          <h3>Context:</h3>\r\n          <FullTextEditDiv>\r\n            <FullTextEditor\r\n              html={html}\r\n              setFullText={(e) => {\r\n                setHtml(e);\r\n              }}\r\n            />\r\n          </FullTextEditDiv>\r\n          <Button onClick={() => updateBlog()} variant=\"contained\">\r\n            Update\r\n          </Button>\r\n        </StyledBlogAddBody>\r\n      )}\r\n    </>\r\n  );\r\n};\r\nexport default BlogUpdatePage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}