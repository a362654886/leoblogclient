{"ast":null,"code":"import _regeneratorRuntime from\"D:/Github/Leo_log_project/leoblogclient/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Github/Leo_log_project/leoblogclient/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import*as React from\"react\";import{useMemo,useRef}from\"react\";import ReactQuill from\"react-quill\";import{ReactQuillDiv}from\"./style\";import{uploadImage}from\"../../../../aws/awsImage\";import{jsx as _jsx}from\"react/jsx-runtime\";var FullTextEditor=function FullTextEditor(_ref){var html=_ref.html,setFullText=_ref.setFullText;var textInput=useRef(null);var handlerImage=function handlerImage(){var input=document.createElement(\"input\");input.setAttribute(\"type\",\"file\");input.setAttribute(\"accept\",\"image/*\");input.setAttribute(\"multiple\",\"multiple\");input.click();input.onchange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var files;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:files=input.files;if(files){Array.from(files).forEach(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(item){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:uploadImage(item,item.name,function(){var quill=(textInput===null||textInput===void 0?void 0:textInput.current).getEditor();//获取到编辑器本身\nvar cursorPosition=quill.getSelection().index;//获取当前光标位置\nquill.insertEmbed(cursorPosition,\"image\",\"https://leoblogimages.s3.amazonaws.com/\".concat(item.name));//插入图片\nquill.setSelection(cursorPosition+1);//光标位置加1\n});case 1:case\"end\":return _context.stop();}},_callee);}));return function(_x2){return _ref3.apply(this,arguments);};}());}case 2:case\"end\":return _context2.stop();}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();};var modules=useMemo(function(){return{toolbar:{container:[[{header:\"1\"},{header:\"2\"},{codeBlock:true},{font:[]}],[{size:[]}],[\"bold\",\"italic\",\"underline\",\"strike\",\"blockquote\"],[{list:\"ordered\"},{list:\"bullet\"},{indent:\"-1\"},{indent:\"+1\"}],[\"link\",\"code-block\"],[\"clean\"]],handlers:{image:handlerImage}},clipboard:{// toggle to add extra line breaks when pasting HTML:\nmatchVisual:false}};},[]);return/*#__PURE__*/_jsx(ReactQuillDiv,{children:/*#__PURE__*/_jsx(ReactQuill,{ref:textInput,theme:\"snow\",onChange:function onChange(e){return setFullText(e);},value:html,modules:modules,bounds:\".app\"})});};export default FullTextEditor;","map":{"version":3,"names":["React","useMemo","useRef","ReactQuill","ReactQuillDiv","uploadImage","jsx","_jsx","FullTextEditor","_ref","html","setFullText","textInput","handlerImage","input","document","createElement","setAttribute","click","onchange","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","e","files","wrap","_callee2$","_context2","prev","next","Array","from","forEach","_ref3","_callee","item","_callee$","_context","name","quill","current","getEditor","cursorPosition","getSelection","index","insertEmbed","concat","setSelection","stop","_x2","apply","arguments","_x","modules","toolbar","container","header","codeBlock","font","size","list","indent","handlers","image","clipboard","matchVisual","children","ref","theme","onChange","value","bounds"],"sources":["D:/Github/Leo_log_project/leoblogclient/src/pages/BlogAddPage/components/FullTextEditor/FullTextEditor.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useMemo, useRef } from \"react\";\r\nimport ReactQuill from \"react-quill\";\r\nimport { ReactQuillDiv } from \"./style\";\r\nimport { uploadImage } from \"../../../../aws/awsImage\";\r\n\r\nexport type ImageCheck = {\r\n  width: number;\r\n  height: number;\r\n};\r\n\r\ninterface IProps {\r\n  html: string;\r\n  setFullText: (html: string) => void;\r\n}\r\n\r\nconst FullTextEditor = ({ html, setFullText }: IProps): JSX.Element => {\r\n  const textInput = useRef(null);\r\n\r\n  const handlerImage = () => {\r\n    const input = document.createElement(\"input\");\r\n    input.setAttribute(\"type\", \"file\");\r\n    input.setAttribute(\"accept\", \"image/*\");\r\n    input.setAttribute(\"multiple\", \"multiple\");\r\n    input.click();\r\n    input.onchange = async (e: any) => {\r\n      const files = input.files;\r\n      if (files) {\r\n        Array.from(files).forEach(async (item) => {\r\n          uploadImage(item, item.name, () => {\r\n            const quill = (textInput?.current as any).getEditor(); //获取到编辑器本身\r\n            const cursorPosition = quill.getSelection().index; //获取当前光标位置\r\n            quill.insertEmbed(\r\n              cursorPosition,\r\n              \"image\",\r\n              `https://leoblogimages.s3.amazonaws.com/${item.name}`\r\n            ); //插入图片\r\n            quill.setSelection(cursorPosition + 1); //光标位置加1\r\n          });\r\n        });\r\n      }\r\n    };\r\n  };\r\n\r\n  const modules = useMemo(\r\n    () => ({\r\n      toolbar: {\r\n        container: [\r\n          [{ header: \"1\" }, { header: \"2\" }, { codeBlock: true }, { font: [] }],\r\n          [{ size: [] }],\r\n          [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\r\n          [\r\n            { list: \"ordered\" },\r\n            { list: \"bullet\" },\r\n            { indent: \"-1\" },\r\n            { indent: \"+1\" },\r\n          ],\r\n          [\"link\",  \"code-block\"],\r\n          [\"clean\"],\r\n        ],\r\n        handlers: {\r\n          image: handlerImage,\r\n        },\r\n      },\r\n      clipboard: {\r\n        // toggle to add extra line breaks when pasting HTML:\r\n        matchVisual: false,\r\n      },\r\n    }),\r\n    []\r\n  );\r\n\r\n  return (\r\n    <ReactQuillDiv>\r\n      <ReactQuill\r\n        ref={textInput}\r\n        theme={\"snow\"}\r\n        onChange={(e) => setFullText(e)}\r\n        value={html}\r\n        modules={modules}\r\n        bounds={\".app\"}\r\n      />\r\n    </ReactQuillDiv>\r\n  );\r\n};\r\n\r\nexport default FullTextEditor;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}